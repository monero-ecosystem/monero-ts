"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _assert = _interopRequireDefault(require("assert"));
var _MoneroDestination = _interopRequireDefault(require("./MoneroDestination"));
var _MoneroError = _interopRequireDefault(require("../../common/MoneroError"));


/**
 * Configures a transaction to send, sweep, or create a payment URI.
 */
class MoneroTxConfig {

  /** Single destination address (required unless `destinations` provided). */


  /** Single destination amount (required unless `destinations provided). */


  /** Source account index to transfer funds from (required unless sweeping key image). */


  /** Source subaddress index to send funds from (default all). */


  /** Source subaddresses to send funds from (default all). */


  /** Relay the transaction to peers to commit to the blockchain if true (default false). */


  /** Transaction priority to adjust the miner fee (default MoneroTxPriority.NORMAL). */


  /** Multiple destinations to send funds to, if applicable. */


  /** List of destination indices to split the miner fee (optional). */


  /** Payment ID for the transaction. */


  /** Minimum height or timestamp for the transaction to unlock (default 0). */


  /** Miner fee (calculated automatically). */


  /** Transaction note saved locally with the wallet (optional). */


  /** Recipient name saved locally with the wallet (optional). */


  /** Allow funds to be transferred using multiple transactions if necessary (default false). */


  /** For sweep requests, include outputs below this amount when sweeping wallet, account, subaddress, or all unlocked funds. */


  /** For sweep requests, sweep each subaddress individually instead of together if true. */


  /** For sweep requests, key image of the output to sweep. */


  /**
   * <p>Generic request to transfer funds from a wallet.</p>
   * 
   * <p>Example:</p>
   * 
   * <code>
   * let config1 = new MoneroTxConfig({<br>
   * &nbsp;&nbsp; accountIndex: 0,<br>
   * &nbsp;&nbsp; address: "59aZULsUF3YN...",<br>
   * &nbsp;&nbsp; amount: 500000n,<br>
   * &nbsp;&nbsp; priority: MoneroTxPriority.NORMAL,<br>
   * &nbsp;&nbsp; relay: true<br>
   * });
   * </code>
   * 
   * @param {Partial<MoneroTxConfig>} [config] - configures the transaction to create (optional)
   * @param {string} [config.address] - single destination address
   * @param {bigint} [config.amount] - single destination amount
   * @param {number} [config.accountIndex] - source account index to transfer funds from
   * @param {number} [config.subaddressIndex] - source subaddress index to transfer funds from
   * @param {number[]} [config.subaddressIndices] - source subaddress indices to transfer funds from
   * @param {boolean} [config.relay] - relay the transaction to peers to commit to the blockchain
   * @param {MoneroTxPriority} [config.priority] - transaction priority (default MoneroTxPriority.NORMAL)
   * @param {MoneroDestination[]} [config.destinations] - addresses and amounts in a multi-destination tx
   * @param {number[]} [config.subtractFeeFrom] - list of destination indices to split the transaction fee
   * @param {string} [config.paymentId] - transaction payment ID
   * @param {bigint} [config.unlockTime] - minimum height or timestamp for the transaction to unlock (default 0)
   * @param {string} [config.note] - transaction note saved locally with the wallet
   * @param {string} [config.recipientName] - recipient name saved locally with the wallet
   * @param {boolean} [config.canSplit] - allow funds to be transferred using multiple transactions
   * @param {bigint} [config.belowAmount] - for sweep requests, include outputs below this amount when sweeping wallet, account, subaddress, or all unlocked funds 
   * @param {boolean} [config.sweepEachSubaddress] - for sweep requests, sweep each subaddress individually instead of together if true
   * @param {string} [config.keyImage] - key image to sweep (ignored except in sweepOutput() requests)
   */
  constructor(config) {
    Object.assign(this, config);

    // deserialize bigints
    if (this.amount !== undefined && typeof this.amount !== "bigint") this.amount = BigInt(this.amount);
    if (this.fee !== undefined && typeof this.fee !== "bigint") this.fee = BigInt(this.fee);
    if (this.unlockTime !== undefined && typeof this.unlockTime !== "bigint") this.unlockTime = BigInt(this.unlockTime);
    if (this.belowAmount !== undefined && typeof this.belowAmount !== "bigint") this.belowAmount = BigInt(this.belowAmount);

    // copy destinations
    if (this.destinations) {
      (0, _assert.default)(this.address === undefined && this.amount === undefined, "Tx configuration may specify destinations or an address/amount but not both");
      this.setDestinations(this.destinations.map((destination) => new _MoneroDestination.default(destination)));
    }

    // alias 'address' and 'amount' to single destination to support e.g. createTx({address: "..."})
    if (this.address || this.amount) {
      (0, _assert.default)(!this.destinations, "Tx configuration may specify destinations or an address/amount but not both");
      this.setAddress(this.address);
      this.setAmount(this.amount);
      delete this.address;
      delete this.amount;
    }

    // alias 'subaddressIndex' to subaddress indices
    if (this.subaddressIndex !== undefined) {
      this.setSubaddressIndices([this.subaddressIndex]);
      delete this.subaddressIndex;
    }
  }

  copy() {
    return new MoneroTxConfig(this);
  }

  toJson() {
    let json = Object.assign({}, this); // copy state
    if (this.getDestinations() !== undefined) {
      json.destinations = [];
      for (let destination of this.getDestinations()) json.destinations.push(destination.toJson());
    }
    if (this.getFee()) json.fee = this.getFee().toString();
    if (this.getUnlockTime()) json.unlockTime = this.getUnlockTime().toString();
    if (this.getBelowAmount()) json.belowAmount = this.getBelowAmount().toString();
    return json;
  }

  /**
   * Set the address of a single-destination configuration.
   * 
   * @param {string} address - the address to set for the single destination
   * @return {MoneroTxConfig} this configuration for chaining
   */
  setAddress(address) {
    if (this.destinations !== undefined && this.destinations.length > 1) throw new _MoneroError.default("Cannot set address because MoneroTxConfig already has multiple destinations");
    if (this.destinations === undefined || this.destinations.length === 0) this.addDestination(new _MoneroDestination.default(address));else
    this.destinations[0].setAddress(address);
    return this;
  }

  /**
   * Get the address of a single-destination configuration.
   * 
   * @return {string} the address of the single destination
   */
  getAddress() {
    if (this.destinations === undefined || this.destinations.length !== 1) throw new _MoneroError.default("Cannot get address because MoneroTxConfig does not have exactly one destination");
    return this.destinations[0].getAddress();
  }

  /**
   * Set the amount of a single-destination configuration.
   * 
   * @param {bigint} amount - the amount to set for the single destination
   * @return {MoneroTxConfig} this configuration for chaining
   */
  setAmount(amount) {
    if (amount !== undefined && typeof this.amount !== "bigint") {
      if (typeof amount === "number") throw new _MoneroError.default("Destination amount must be bigint or string");
      try {amount = BigInt(amount);}
      catch (err) {throw new _MoneroError.default("Invalid destination amount: " + amount);}
    }
    if (this.destinations !== undefined && this.destinations.length > 1) throw new _MoneroError.default("Cannot set amount because MoneroTxConfig already has multiple destinations");
    if (this.destinations === undefined || this.destinations.length === 0) this.addDestination(new _MoneroDestination.default(undefined, amount));else
    this.destinations[0].setAmount(amount);
    return this;
  }

  /**
   * Get the amount of a single-destination configuration.
   * 
   * @return {bigint} the amount of the single destination
   */
  getAmount() {
    if (this.destinations === undefined || this.destinations.length !== 1) throw new _MoneroError.default("Cannot get amount because MoneroTxConfig does not have exactly one destination");
    return this.destinations[0].getAmount();
  }

  addDestination(destinationOrAddress, amount) {
    if (typeof destinationOrAddress === "string") return this.addDestination(new _MoneroDestination.default(destinationOrAddress, amount));
    (0, _assert.default)(destinationOrAddress instanceof _MoneroDestination.default);
    if (this.destinations === undefined) this.destinations = [];
    this.destinations.push(destinationOrAddress);
    return this;
  }

  getDestinations() {
    return this.destinations;
  }

  setDestinations(destinations) {
    if (arguments.length > 1) destinations = Array.from(arguments);
    this.destinations = destinations;
    return this;
  }

  setDestination(destination) {
    return this.setDestinations(destination ? [destination] : undefined);
  }

  getSubtractFeeFrom() {
    return this.subtractFeeFrom;
  }

  setSubtractFeeFrom(destinationIndices) {
    if (arguments.length > 1) destinationIndices = Array.from(arguments);
    this.subtractFeeFrom = destinationIndices;
    return this;
  }

  getPaymentId() {
    return this.paymentId;
  }

  setPaymentId(paymentId) {
    this.paymentId = paymentId;
    return this;
  }

  getPriority() {
    return this.priority;
  }

  setPriority(priority) {
    this.priority = priority;
    return this;
  }

  getFee() {
    return this.fee;
  }

  setFee(fee) {
    this.fee = fee;
    return this;
  }

  getAccountIndex() {
    return this.accountIndex;
  }

  setAccountIndex(accountIndex) {
    this.accountIndex = accountIndex;
    return this;
  }

  setSubaddressIndex(subaddressIndex) {
    this.setSubaddressIndices([subaddressIndex]);
    return this;
  }

  getSubaddressIndices() {
    return this.subaddressIndices;
  }

  setSubaddressIndices(subaddressIndices) {
    if (arguments.length > 1) subaddressIndices = Array.from(arguments);
    this.subaddressIndices = subaddressIndices;
    return this;
  }

  getUnlockTime() {
    return this.unlockTime;
  }

  setUnlockTime(unlockTime) {
    this.unlockTime = unlockTime;
    return this;
  }

  getRelay() {
    return this.relay;
  }

  setRelay(relay) {
    this.relay = relay;
    return this;
  }

  getCanSplit() {
    return this.canSplit;
  }

  setCanSplit(canSplit) {
    this.canSplit = canSplit;
    return this;
  }

  getNote() {
    return this.note;
  }

  setNote(note) {
    this.note = note;
    return this;
  }

  getRecipientName() {
    return this.recipientName;
  }

  setRecipientName(recipientName) {
    this.recipientName = recipientName;
    return this;
  }

  // --------------------------- SPECIFIC TO SWEEP ----------------------------

  getBelowAmount() {
    return this.belowAmount;
  }

  setBelowAmount(belowAmount) {
    this.belowAmount = belowAmount;
    return this;
  }

  getSweepEachSubaddress() {
    return this.sweepEachSubaddress;
  }

  setSweepEachSubaddress(sweepEachSubaddress) {
    this.sweepEachSubaddress = sweepEachSubaddress;
    return this;
  }

  /**
   * Get the key image hex of the output to sweep.
   * 
   * return {string} is the key image hex of the output to sweep
   */
  getKeyImage() {
    return this.keyImage;
  }

  /**
   * Set the key image hex of the output to sweep.
   * 
   * @param {string} keyImage is the key image hex of the output to sweep
   */
  setKeyImage(keyImage) {
    this.keyImage = keyImage;
    return this;
  }
}exports.default = MoneroTxConfig;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYXNzZXJ0IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfTW9uZXJvRGVzdGluYXRpb24iLCJfTW9uZXJvRXJyb3IiLCJNb25lcm9UeENvbmZpZyIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwiT2JqZWN0IiwiYXNzaWduIiwiYW1vdW50IiwidW5kZWZpbmVkIiwiQmlnSW50IiwiZmVlIiwidW5sb2NrVGltZSIsImJlbG93QW1vdW50IiwiZGVzdGluYXRpb25zIiwiYXNzZXJ0IiwiYWRkcmVzcyIsInNldERlc3RpbmF0aW9ucyIsIm1hcCIsImRlc3RpbmF0aW9uIiwiTW9uZXJvRGVzdGluYXRpb24iLCJzZXRBZGRyZXNzIiwic2V0QW1vdW50Iiwic3ViYWRkcmVzc0luZGV4Iiwic2V0U3ViYWRkcmVzc0luZGljZXMiLCJjb3B5IiwidG9Kc29uIiwianNvbiIsImdldERlc3RpbmF0aW9ucyIsInB1c2giLCJnZXRGZWUiLCJ0b1N0cmluZyIsImdldFVubG9ja1RpbWUiLCJnZXRCZWxvd0Ftb3VudCIsImxlbmd0aCIsIk1vbmVyb0Vycm9yIiwiYWRkRGVzdGluYXRpb24iLCJnZXRBZGRyZXNzIiwiZXJyIiwiZ2V0QW1vdW50IiwiZGVzdGluYXRpb25PckFkZHJlc3MiLCJhcmd1bWVudHMiLCJBcnJheSIsImZyb20iLCJzZXREZXN0aW5hdGlvbiIsImdldFN1YnRyYWN0RmVlRnJvbSIsInN1YnRyYWN0RmVlRnJvbSIsInNldFN1YnRyYWN0RmVlRnJvbSIsImRlc3RpbmF0aW9uSW5kaWNlcyIsImdldFBheW1lbnRJZCIsInBheW1lbnRJZCIsInNldFBheW1lbnRJZCIsImdldFByaW9yaXR5IiwicHJpb3JpdHkiLCJzZXRQcmlvcml0eSIsInNldEZlZSIsImdldEFjY291bnRJbmRleCIsImFjY291bnRJbmRleCIsInNldEFjY291bnRJbmRleCIsInNldFN1YmFkZHJlc3NJbmRleCIsImdldFN1YmFkZHJlc3NJbmRpY2VzIiwic3ViYWRkcmVzc0luZGljZXMiLCJzZXRVbmxvY2tUaW1lIiwiZ2V0UmVsYXkiLCJyZWxheSIsInNldFJlbGF5IiwiZ2V0Q2FuU3BsaXQiLCJjYW5TcGxpdCIsInNldENhblNwbGl0IiwiZ2V0Tm90ZSIsIm5vdGUiLCJzZXROb3RlIiwiZ2V0UmVjaXBpZW50TmFtZSIsInJlY2lwaWVudE5hbWUiLCJzZXRSZWNpcGllbnROYW1lIiwic2V0QmVsb3dBbW91bnQiLCJnZXRTd2VlcEVhY2hTdWJhZGRyZXNzIiwic3dlZXBFYWNoU3ViYWRkcmVzcyIsInNldFN3ZWVwRWFjaFN1YmFkZHJlc3MiLCJnZXRLZXlJbWFnZSIsImtleUltYWdlIiwic2V0S2V5SW1hZ2UiLCJleHBvcnRzIiwiZGVmYXVsdCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9tYWluL3RzL3dhbGxldC9tb2RlbC9Nb25lcm9UeENvbmZpZy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXNzZXJ0IGZyb20gXCJhc3NlcnRcIjtcbmltcG9ydCBNb25lcm9EZXN0aW5hdGlvbiBmcm9tIFwiLi9Nb25lcm9EZXN0aW5hdGlvblwiO1xuaW1wb3J0IE1vbmVyb0Vycm9yIGZyb20gXCIuLi8uLi9jb21tb24vTW9uZXJvRXJyb3JcIjtcbmltcG9ydCBNb25lcm9UeFByaW9yaXR5IGZyb20gXCIuL01vbmVyb1R4UHJpb3JpdHlcIjtcblxuLyoqXG4gKiBDb25maWd1cmVzIGEgdHJhbnNhY3Rpb24gdG8gc2VuZCwgc3dlZXAsIG9yIGNyZWF0ZSBhIHBheW1lbnQgVVJJLlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb25lcm9UeENvbmZpZyB7XG5cbiAgLyoqIFNpbmdsZSBkZXN0aW5hdGlvbiBhZGRyZXNzIChyZXF1aXJlZCB1bmxlc3MgYGRlc3RpbmF0aW9uc2AgcHJvdmlkZWQpLiAqL1xuICBhZGRyZXNzOiBzdHJpbmc7XG5cbiAgLyoqIFNpbmdsZSBkZXN0aW5hdGlvbiBhbW91bnQgKHJlcXVpcmVkIHVubGVzcyBgZGVzdGluYXRpb25zIHByb3ZpZGVkKS4gKi9cbiAgYW1vdW50OiBiaWdpbnQ7XG5cbiAgLyoqIFNvdXJjZSBhY2NvdW50IGluZGV4IHRvIHRyYW5zZmVyIGZ1bmRzIGZyb20gKHJlcXVpcmVkIHVubGVzcyBzd2VlcGluZyBrZXkgaW1hZ2UpLiAqL1xuICBhY2NvdW50SW5kZXg6IG51bWJlcjtcblxuICAvKiogU291cmNlIHN1YmFkZHJlc3MgaW5kZXggdG8gc2VuZCBmdW5kcyBmcm9tIChkZWZhdWx0IGFsbCkuICovXG4gIHN1YmFkZHJlc3NJbmRleDogbnVtYmVyO1xuXG4gIC8qKiBTb3VyY2Ugc3ViYWRkcmVzc2VzIHRvIHNlbmQgZnVuZHMgZnJvbSAoZGVmYXVsdCBhbGwpLiAqL1xuICBzdWJhZGRyZXNzSW5kaWNlczogbnVtYmVyW107XG5cbiAgLyoqIFJlbGF5IHRoZSB0cmFuc2FjdGlvbiB0byBwZWVycyB0byBjb21taXQgdG8gdGhlIGJsb2NrY2hhaW4gaWYgdHJ1ZSAoZGVmYXVsdCBmYWxzZSkuICovXG4gIHJlbGF5OiBib29sZWFuO1xuXG4gIC8qKiBUcmFuc2FjdGlvbiBwcmlvcml0eSB0byBhZGp1c3QgdGhlIG1pbmVyIGZlZSAoZGVmYXVsdCBNb25lcm9UeFByaW9yaXR5Lk5PUk1BTCkuICovXG4gIHByaW9yaXR5OiBNb25lcm9UeFByaW9yaXR5O1xuXG4gIC8qKiBNdWx0aXBsZSBkZXN0aW5hdGlvbnMgdG8gc2VuZCBmdW5kcyB0bywgaWYgYXBwbGljYWJsZS4gKi9cbiAgZGVzdGluYXRpb25zOiBQYXJ0aWFsPE1vbmVyb0Rlc3RpbmF0aW9uPltdO1xuXG4gIC8qKiBMaXN0IG9mIGRlc3RpbmF0aW9uIGluZGljZXMgdG8gc3BsaXQgdGhlIG1pbmVyIGZlZSAob3B0aW9uYWwpLiAqL1xuICBzdWJ0cmFjdEZlZUZyb206IG51bWJlcltdO1xuXG4gIC8qKiBQYXltZW50IElEIGZvciB0aGUgdHJhbnNhY3Rpb24uICovXG4gIHBheW1lbnRJZDogc3RyaW5nO1xuXG4gIC8qKiBNaW5pbXVtIGhlaWdodCBvciB0aW1lc3RhbXAgZm9yIHRoZSB0cmFuc2FjdGlvbiB0byB1bmxvY2sgKGRlZmF1bHQgMCkuICovXG4gIHVubG9ja1RpbWU6IGJpZ2ludDtcblxuICAvKiogTWluZXIgZmVlIChjYWxjdWxhdGVkIGF1dG9tYXRpY2FsbHkpLiAqL1xuICBmZWU6IGJpZ2ludDtcblxuICAvKiogVHJhbnNhY3Rpb24gbm90ZSBzYXZlZCBsb2NhbGx5IHdpdGggdGhlIHdhbGxldCAob3B0aW9uYWwpLiAqL1xuICBub3RlOiBzdHJpbmc7XG5cbiAgLyoqIFJlY2lwaWVudCBuYW1lIHNhdmVkIGxvY2FsbHkgd2l0aCB0aGUgd2FsbGV0IChvcHRpb25hbCkuICovXG4gIHJlY2lwaWVudE5hbWU6IHN0cmluZztcblxuICAvKiogQWxsb3cgZnVuZHMgdG8gYmUgdHJhbnNmZXJyZWQgdXNpbmcgbXVsdGlwbGUgdHJhbnNhY3Rpb25zIGlmIG5lY2Vzc2FyeSAoZGVmYXVsdCBmYWxzZSkuICovXG4gIGNhblNwbGl0OiBib29sZWFuO1xuXG4gIC8qKiBGb3Igc3dlZXAgcmVxdWVzdHMsIGluY2x1ZGUgb3V0cHV0cyBiZWxvdyB0aGlzIGFtb3VudCB3aGVuIHN3ZWVwaW5nIHdhbGxldCwgYWNjb3VudCwgc3ViYWRkcmVzcywgb3IgYWxsIHVubG9ja2VkIGZ1bmRzLiAqL1xuICBiZWxvd0Ftb3VudDogYmlnaW50O1xuXG4gIC8qKiBGb3Igc3dlZXAgcmVxdWVzdHMsIHN3ZWVwIGVhY2ggc3ViYWRkcmVzcyBpbmRpdmlkdWFsbHkgaW5zdGVhZCBvZiB0b2dldGhlciBpZiB0cnVlLiAqL1xuICBzd2VlcEVhY2hTdWJhZGRyZXNzOiBib29sZWFuO1xuXG4gIC8qKiBGb3Igc3dlZXAgcmVxdWVzdHMsIGtleSBpbWFnZSBvZiB0aGUgb3V0cHV0IHRvIHN3ZWVwLiAqL1xuICBrZXlJbWFnZTogc3RyaW5nO1xuICBcbiAgLyoqXG4gICAqIDxwPkdlbmVyaWMgcmVxdWVzdCB0byB0cmFuc2ZlciBmdW5kcyBmcm9tIGEgd2FsbGV0LjwvcD5cbiAgICogXG4gICAqIDxwPkV4YW1wbGU6PC9wPlxuICAgKiBcbiAgICogPGNvZGU+XG4gICAqIGxldCBjb25maWcxID0gbmV3IE1vbmVyb1R4Q29uZmlnKHs8YnI+XG4gICAqICZuYnNwOyZuYnNwOyBhY2NvdW50SW5kZXg6IDAsPGJyPlxuICAgKiAmbmJzcDsmbmJzcDsgYWRkcmVzczogXCI1OWFaVUxzVUYzWU4uLi5cIiw8YnI+XG4gICAqICZuYnNwOyZuYnNwOyBhbW91bnQ6IDUwMDAwMG4sPGJyPlxuICAgKiAmbmJzcDsmbmJzcDsgcHJpb3JpdHk6IE1vbmVyb1R4UHJpb3JpdHkuTk9STUFMLDxicj5cbiAgICogJm5ic3A7Jm5ic3A7IHJlbGF5OiB0cnVlPGJyPlxuICAgKiB9KTtcbiAgICogPC9jb2RlPlxuICAgKiBcbiAgICogQHBhcmFtIHtQYXJ0aWFsPE1vbmVyb1R4Q29uZmlnPn0gW2NvbmZpZ10gLSBjb25maWd1cmVzIHRoZSB0cmFuc2FjdGlvbiB0byBjcmVhdGUgKG9wdGlvbmFsKVxuICAgKiBAcGFyYW0ge3N0cmluZ30gW2NvbmZpZy5hZGRyZXNzXSAtIHNpbmdsZSBkZXN0aW5hdGlvbiBhZGRyZXNzXG4gICAqIEBwYXJhbSB7YmlnaW50fSBbY29uZmlnLmFtb3VudF0gLSBzaW5nbGUgZGVzdGluYXRpb24gYW1vdW50XG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbY29uZmlnLmFjY291bnRJbmRleF0gLSBzb3VyY2UgYWNjb3VudCBpbmRleCB0byB0cmFuc2ZlciBmdW5kcyBmcm9tXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbY29uZmlnLnN1YmFkZHJlc3NJbmRleF0gLSBzb3VyY2Ugc3ViYWRkcmVzcyBpbmRleCB0byB0cmFuc2ZlciBmdW5kcyBmcm9tXG4gICAqIEBwYXJhbSB7bnVtYmVyW119IFtjb25maWcuc3ViYWRkcmVzc0luZGljZXNdIC0gc291cmNlIHN1YmFkZHJlc3MgaW5kaWNlcyB0byB0cmFuc2ZlciBmdW5kcyBmcm9tXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2NvbmZpZy5yZWxheV0gLSByZWxheSB0aGUgdHJhbnNhY3Rpb24gdG8gcGVlcnMgdG8gY29tbWl0IHRvIHRoZSBibG9ja2NoYWluXG4gICAqIEBwYXJhbSB7TW9uZXJvVHhQcmlvcml0eX0gW2NvbmZpZy5wcmlvcml0eV0gLSB0cmFuc2FjdGlvbiBwcmlvcml0eSAoZGVmYXVsdCBNb25lcm9UeFByaW9yaXR5Lk5PUk1BTClcbiAgICogQHBhcmFtIHtNb25lcm9EZXN0aW5hdGlvbltdfSBbY29uZmlnLmRlc3RpbmF0aW9uc10gLSBhZGRyZXNzZXMgYW5kIGFtb3VudHMgaW4gYSBtdWx0aS1kZXN0aW5hdGlvbiB0eFxuICAgKiBAcGFyYW0ge251bWJlcltdfSBbY29uZmlnLnN1YnRyYWN0RmVlRnJvbV0gLSBsaXN0IG9mIGRlc3RpbmF0aW9uIGluZGljZXMgdG8gc3BsaXQgdGhlIHRyYW5zYWN0aW9uIGZlZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gW2NvbmZpZy5wYXltZW50SWRdIC0gdHJhbnNhY3Rpb24gcGF5bWVudCBJRFxuICAgKiBAcGFyYW0ge2JpZ2ludH0gW2NvbmZpZy51bmxvY2tUaW1lXSAtIG1pbmltdW0gaGVpZ2h0IG9yIHRpbWVzdGFtcCBmb3IgdGhlIHRyYW5zYWN0aW9uIHRvIHVubG9jayAoZGVmYXVsdCAwKVxuICAgKiBAcGFyYW0ge3N0cmluZ30gW2NvbmZpZy5ub3RlXSAtIHRyYW5zYWN0aW9uIG5vdGUgc2F2ZWQgbG9jYWxseSB3aXRoIHRoZSB3YWxsZXRcbiAgICogQHBhcmFtIHtzdHJpbmd9IFtjb25maWcucmVjaXBpZW50TmFtZV0gLSByZWNpcGllbnQgbmFtZSBzYXZlZCBsb2NhbGx5IHdpdGggdGhlIHdhbGxldFxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtjb25maWcuY2FuU3BsaXRdIC0gYWxsb3cgZnVuZHMgdG8gYmUgdHJhbnNmZXJyZWQgdXNpbmcgbXVsdGlwbGUgdHJhbnNhY3Rpb25zXG4gICAqIEBwYXJhbSB7YmlnaW50fSBbY29uZmlnLmJlbG93QW1vdW50XSAtIGZvciBzd2VlcCByZXF1ZXN0cywgaW5jbHVkZSBvdXRwdXRzIGJlbG93IHRoaXMgYW1vdW50IHdoZW4gc3dlZXBpbmcgd2FsbGV0LCBhY2NvdW50LCBzdWJhZGRyZXNzLCBvciBhbGwgdW5sb2NrZWQgZnVuZHMgXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2NvbmZpZy5zd2VlcEVhY2hTdWJhZGRyZXNzXSAtIGZvciBzd2VlcCByZXF1ZXN0cywgc3dlZXAgZWFjaCBzdWJhZGRyZXNzIGluZGl2aWR1YWxseSBpbnN0ZWFkIG9mIHRvZ2V0aGVyIGlmIHRydWVcbiAgICogQHBhcmFtIHtzdHJpbmd9IFtjb25maWcua2V5SW1hZ2VdIC0ga2V5IGltYWdlIHRvIHN3ZWVwIChpZ25vcmVkIGV4Y2VwdCBpbiBzd2VlcE91dHB1dCgpIHJlcXVlc3RzKVxuICAgKi9cbiAgY29uc3RydWN0b3IoY29uZmlnPzogUGFydGlhbDxNb25lcm9UeENvbmZpZz4pIHtcbiAgICBPYmplY3QuYXNzaWduKHRoaXMsIGNvbmZpZyk7XG5cbiAgICAvLyBkZXNlcmlhbGl6ZSBiaWdpbnRzXG4gICAgaWYgKHRoaXMuYW1vdW50ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHRoaXMuYW1vdW50ICE9PSBcImJpZ2ludFwiKSB0aGlzLmFtb3VudCA9IEJpZ0ludCh0aGlzLmFtb3VudCk7XG4gICAgaWYgKHRoaXMuZmVlICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHRoaXMuZmVlICE9PSBcImJpZ2ludFwiKSB0aGlzLmZlZSA9IEJpZ0ludCh0aGlzLmZlZSk7XG4gICAgaWYgKHRoaXMudW5sb2NrVGltZSAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiB0aGlzLnVubG9ja1RpbWUgIT09IFwiYmlnaW50XCIpIHRoaXMudW5sb2NrVGltZSA9IEJpZ0ludCh0aGlzLnVubG9ja1RpbWUpO1xuICAgIGlmICh0aGlzLmJlbG93QW1vdW50ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHRoaXMuYmVsb3dBbW91bnQgIT09IFwiYmlnaW50XCIpIHRoaXMuYmVsb3dBbW91bnQgPSBCaWdJbnQodGhpcy5iZWxvd0Ftb3VudCk7XG5cbiAgICAvLyBjb3B5IGRlc3RpbmF0aW9uc1xuICAgIGlmICh0aGlzLmRlc3RpbmF0aW9ucykge1xuICAgICAgYXNzZXJ0KHRoaXMuYWRkcmVzcyA9PT0gdW5kZWZpbmVkICYmIHRoaXMuYW1vdW50ID09PSB1bmRlZmluZWQsIFwiVHggY29uZmlndXJhdGlvbiBtYXkgc3BlY2lmeSBkZXN0aW5hdGlvbnMgb3IgYW4gYWRkcmVzcy9hbW91bnQgYnV0IG5vdCBib3RoXCIpO1xuICAgICAgdGhpcy5zZXREZXN0aW5hdGlvbnModGhpcy5kZXN0aW5hdGlvbnMubWFwKGRlc3RpbmF0aW9uID0+IG5ldyBNb25lcm9EZXN0aW5hdGlvbihkZXN0aW5hdGlvbikpKTtcbiAgICB9XG4gICAgXG4gICAgLy8gYWxpYXMgJ2FkZHJlc3MnIGFuZCAnYW1vdW50JyB0byBzaW5nbGUgZGVzdGluYXRpb24gdG8gc3VwcG9ydCBlLmcuIGNyZWF0ZVR4KHthZGRyZXNzOiBcIi4uLlwifSlcbiAgICBpZiAodGhpcy5hZGRyZXNzIHx8IHRoaXMuYW1vdW50KSB7XG4gICAgICBhc3NlcnQoIXRoaXMuZGVzdGluYXRpb25zLCBcIlR4IGNvbmZpZ3VyYXRpb24gbWF5IHNwZWNpZnkgZGVzdGluYXRpb25zIG9yIGFuIGFkZHJlc3MvYW1vdW50IGJ1dCBub3QgYm90aFwiKTtcbiAgICAgIHRoaXMuc2V0QWRkcmVzcyh0aGlzLmFkZHJlc3MpO1xuICAgICAgdGhpcy5zZXRBbW91bnQodGhpcy5hbW91bnQpO1xuICAgICAgZGVsZXRlIHRoaXMuYWRkcmVzcztcbiAgICAgIGRlbGV0ZSB0aGlzLmFtb3VudDtcbiAgICB9XG4gICAgXG4gICAgLy8gYWxpYXMgJ3N1YmFkZHJlc3NJbmRleCcgdG8gc3ViYWRkcmVzcyBpbmRpY2VzXG4gICAgaWYgKHRoaXMuc3ViYWRkcmVzc0luZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuc2V0U3ViYWRkcmVzc0luZGljZXMoW3RoaXMuc3ViYWRkcmVzc0luZGV4XSk7XG4gICAgICBkZWxldGUgdGhpcy5zdWJhZGRyZXNzSW5kZXg7XG4gICAgfVxuICB9XG4gIFxuICBjb3B5KCk6IE1vbmVyb1R4Q29uZmlnIHtcbiAgICByZXR1cm4gbmV3IE1vbmVyb1R4Q29uZmlnKHRoaXMpO1xuICB9XG4gIFxuICB0b0pzb24oKTogYW55IHtcbiAgICBsZXQganNvbjogYW55ID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcyk7IC8vIGNvcHkgc3RhdGVcbiAgICBpZiAodGhpcy5nZXREZXN0aW5hdGlvbnMoKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBqc29uLmRlc3RpbmF0aW9ucyA9IFtdO1xuICAgICAgZm9yIChsZXQgZGVzdGluYXRpb24gb2YgdGhpcy5nZXREZXN0aW5hdGlvbnMoKSkganNvbi5kZXN0aW5hdGlvbnMucHVzaChkZXN0aW5hdGlvbi50b0pzb24oKSk7XG4gICAgfVxuICAgIGlmICh0aGlzLmdldEZlZSgpKSBqc29uLmZlZSA9IHRoaXMuZ2V0RmVlKCkudG9TdHJpbmcoKTtcbiAgICBpZiAodGhpcy5nZXRVbmxvY2tUaW1lKCkpIGpzb24udW5sb2NrVGltZSA9IHRoaXMuZ2V0VW5sb2NrVGltZSgpLnRvU3RyaW5nKCk7XG4gICAgaWYgKHRoaXMuZ2V0QmVsb3dBbW91bnQoKSkganNvbi5iZWxvd0Ftb3VudCA9IHRoaXMuZ2V0QmVsb3dBbW91bnQoKS50b1N0cmluZygpO1xuICAgIHJldHVybiBqc29uO1xuICB9XG4gIFxuICAvKipcbiAgICogU2V0IHRoZSBhZGRyZXNzIG9mIGEgc2luZ2xlLWRlc3RpbmF0aW9uIGNvbmZpZ3VyYXRpb24uXG4gICAqIFxuICAgKiBAcGFyYW0ge3N0cmluZ30gYWRkcmVzcyAtIHRoZSBhZGRyZXNzIHRvIHNldCBmb3IgdGhlIHNpbmdsZSBkZXN0aW5hdGlvblxuICAgKiBAcmV0dXJuIHtNb25lcm9UeENvbmZpZ30gdGhpcyBjb25maWd1cmF0aW9uIGZvciBjaGFpbmluZ1xuICAgKi9cbiAgc2V0QWRkcmVzcyhhZGRyZXNzOiBzdHJpbmcpOiBNb25lcm9UeENvbmZpZyB7XG4gICAgaWYgKHRoaXMuZGVzdGluYXRpb25zICE9PSB1bmRlZmluZWQgJiYgdGhpcy5kZXN0aW5hdGlvbnMubGVuZ3RoID4gMSkgdGhyb3cgbmV3IE1vbmVyb0Vycm9yKFwiQ2Fubm90IHNldCBhZGRyZXNzIGJlY2F1c2UgTW9uZXJvVHhDb25maWcgYWxyZWFkeSBoYXMgbXVsdGlwbGUgZGVzdGluYXRpb25zXCIpO1xuICAgIGlmICh0aGlzLmRlc3RpbmF0aW9ucyA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuZGVzdGluYXRpb25zLmxlbmd0aCA9PT0gMCkgdGhpcy5hZGREZXN0aW5hdGlvbihuZXcgTW9uZXJvRGVzdGluYXRpb24oYWRkcmVzcykpO1xuICAgIGVsc2UgKHRoaXMuZGVzdGluYXRpb25zWzBdIGFzIE1vbmVyb0Rlc3RpbmF0aW9uKS5zZXRBZGRyZXNzKGFkZHJlc3MpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICAvKipcbiAgICogR2V0IHRoZSBhZGRyZXNzIG9mIGEgc2luZ2xlLWRlc3RpbmF0aW9uIGNvbmZpZ3VyYXRpb24uXG4gICAqIFxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IHRoZSBhZGRyZXNzIG9mIHRoZSBzaW5nbGUgZGVzdGluYXRpb25cbiAgICovXG4gIGdldEFkZHJlc3MoKTogc3RyaW5nIHtcbiAgICBpZiAodGhpcy5kZXN0aW5hdGlvbnMgPT09IHVuZGVmaW5lZCB8fCB0aGlzLmRlc3RpbmF0aW9ucy5sZW5ndGggIT09IDEpIHRocm93IG5ldyBNb25lcm9FcnJvcihcIkNhbm5vdCBnZXQgYWRkcmVzcyBiZWNhdXNlIE1vbmVyb1R4Q29uZmlnIGRvZXMgbm90IGhhdmUgZXhhY3RseSBvbmUgZGVzdGluYXRpb25cIik7XG4gICAgcmV0dXJuICh0aGlzLmRlc3RpbmF0aW9uc1swXSBhcyBNb25lcm9EZXN0aW5hdGlvbikuZ2V0QWRkcmVzcygpO1xuICB9XG4gIFxuICAvKipcbiAgICogU2V0IHRoZSBhbW91bnQgb2YgYSBzaW5nbGUtZGVzdGluYXRpb24gY29uZmlndXJhdGlvbi5cbiAgICogXG4gICAqIEBwYXJhbSB7YmlnaW50fSBhbW91bnQgLSB0aGUgYW1vdW50IHRvIHNldCBmb3IgdGhlIHNpbmdsZSBkZXN0aW5hdGlvblxuICAgKiBAcmV0dXJuIHtNb25lcm9UeENvbmZpZ30gdGhpcyBjb25maWd1cmF0aW9uIGZvciBjaGFpbmluZ1xuICAgKi9cbiAgc2V0QW1vdW50KGFtb3VudDogYmlnaW50KTogTW9uZXJvVHhDb25maWcge1xuICAgIGlmIChhbW91bnQgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgdGhpcy5hbW91bnQgIT09IFwiYmlnaW50XCIpIHtcbiAgICAgIGlmICh0eXBlb2YgYW1vdW50ID09PSBcIm51bWJlclwiKSB0aHJvdyBuZXcgTW9uZXJvRXJyb3IoXCJEZXN0aW5hdGlvbiBhbW91bnQgbXVzdCBiZSBiaWdpbnQgb3Igc3RyaW5nXCIpO1xuICAgICAgdHJ5IHsgYW1vdW50ID0gQmlnSW50KGFtb3VudCk7IH1cbiAgICAgIGNhdGNoIChlcnIpIHsgdGhyb3cgbmV3IE1vbmVyb0Vycm9yKFwiSW52YWxpZCBkZXN0aW5hdGlvbiBhbW91bnQ6IFwiICsgYW1vdW50KTsgfVxuICAgIH1cbiAgICBpZiAodGhpcy5kZXN0aW5hdGlvbnMgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmRlc3RpbmF0aW9ucy5sZW5ndGggPiAxKSB0aHJvdyBuZXcgTW9uZXJvRXJyb3IoXCJDYW5ub3Qgc2V0IGFtb3VudCBiZWNhdXNlIE1vbmVyb1R4Q29uZmlnIGFscmVhZHkgaGFzIG11bHRpcGxlIGRlc3RpbmF0aW9uc1wiKTtcbiAgICBpZiAodGhpcy5kZXN0aW5hdGlvbnMgPT09IHVuZGVmaW5lZCB8fCB0aGlzLmRlc3RpbmF0aW9ucy5sZW5ndGggPT09IDApIHRoaXMuYWRkRGVzdGluYXRpb24obmV3IE1vbmVyb0Rlc3RpbmF0aW9uKHVuZGVmaW5lZCwgYW1vdW50KSk7XG4gICAgZWxzZSAodGhpcy5kZXN0aW5hdGlvbnNbMF0gYXMgTW9uZXJvRGVzdGluYXRpb24pLnNldEFtb3VudChhbW91bnQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICAvKipcbiAgICogR2V0IHRoZSBhbW91bnQgb2YgYSBzaW5nbGUtZGVzdGluYXRpb24gY29uZmlndXJhdGlvbi5cbiAgICogXG4gICAqIEByZXR1cm4ge2JpZ2ludH0gdGhlIGFtb3VudCBvZiB0aGUgc2luZ2xlIGRlc3RpbmF0aW9uXG4gICAqL1xuICBnZXRBbW91bnQoKTogYmlnaW50IHtcbiAgICBpZiAodGhpcy5kZXN0aW5hdGlvbnMgPT09IHVuZGVmaW5lZCB8fCB0aGlzLmRlc3RpbmF0aW9ucy5sZW5ndGggIT09IDEpIHRocm93IG5ldyBNb25lcm9FcnJvcihcIkNhbm5vdCBnZXQgYW1vdW50IGJlY2F1c2UgTW9uZXJvVHhDb25maWcgZG9lcyBub3QgaGF2ZSBleGFjdGx5IG9uZSBkZXN0aW5hdGlvblwiKTtcbiAgICByZXR1cm4gKHRoaXMuZGVzdGluYXRpb25zWzBdIGFzIE1vbmVyb0Rlc3RpbmF0aW9uKS5nZXRBbW91bnQoKTtcbiAgfVxuICBcbiAgYWRkRGVzdGluYXRpb24oZGVzdGluYXRpb25PckFkZHJlc3M6IE1vbmVyb0Rlc3RpbmF0aW9uIHwgc3RyaW5nLCBhbW91bnQ/OiBiaWdpbnQpOiBNb25lcm9UeENvbmZpZyB7XG4gICAgaWYgKHR5cGVvZiBkZXN0aW5hdGlvbk9yQWRkcmVzcyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIHRoaXMuYWRkRGVzdGluYXRpb24obmV3IE1vbmVyb0Rlc3RpbmF0aW9uKGRlc3RpbmF0aW9uT3JBZGRyZXNzLCBhbW91bnQpKTtcbiAgICBhc3NlcnQoZGVzdGluYXRpb25PckFkZHJlc3MgaW5zdGFuY2VvZiBNb25lcm9EZXN0aW5hdGlvbik7XG4gICAgaWYgKHRoaXMuZGVzdGluYXRpb25zID09PSB1bmRlZmluZWQpIHRoaXMuZGVzdGluYXRpb25zID0gW107XG4gICAgdGhpcy5kZXN0aW5hdGlvbnMucHVzaChkZXN0aW5hdGlvbk9yQWRkcmVzcyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIGdldERlc3RpbmF0aW9ucygpOiBNb25lcm9EZXN0aW5hdGlvbltdIHtcbiAgICByZXR1cm4gdGhpcy5kZXN0aW5hdGlvbnMgYXMgTW9uZXJvRGVzdGluYXRpb25bXTtcbiAgfVxuICBcbiAgc2V0RGVzdGluYXRpb25zKGRlc3RpbmF0aW9uczogTW9uZXJvRGVzdGluYXRpb25bXSk6IE1vbmVyb1R4Q29uZmlnIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIGRlc3RpbmF0aW9ucyA9IEFycmF5LmZyb20oYXJndW1lbnRzKTtcbiAgICB0aGlzLmRlc3RpbmF0aW9ucyA9IGRlc3RpbmF0aW9ucztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBcbiAgc2V0RGVzdGluYXRpb24oZGVzdGluYXRpb246IE1vbmVyb0Rlc3RpbmF0aW9uKTogTW9uZXJvVHhDb25maWcge1xuICAgIHJldHVybiB0aGlzLnNldERlc3RpbmF0aW9ucyhkZXN0aW5hdGlvbiA/IFtkZXN0aW5hdGlvbl0gOiB1bmRlZmluZWQpO1xuICB9XG5cbiAgZ2V0U3VidHJhY3RGZWVGcm9tKCk6IG51bWJlcltdIHtcbiAgICByZXR1cm4gdGhpcy5zdWJ0cmFjdEZlZUZyb207XG4gIH1cblxuICBzZXRTdWJ0cmFjdEZlZUZyb20oZGVzdGluYXRpb25JbmRpY2VzOiBudW1iZXJbXSk6IE1vbmVyb1R4Q29uZmlnIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIGRlc3RpbmF0aW9uSW5kaWNlcyA9IEFycmF5LmZyb20oYXJndW1lbnRzKTtcbiAgICB0aGlzLnN1YnRyYWN0RmVlRnJvbSA9IGRlc3RpbmF0aW9uSW5kaWNlcztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBcbiAgZ2V0UGF5bWVudElkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMucGF5bWVudElkO1xuICB9XG4gIFxuICBzZXRQYXltZW50SWQocGF5bWVudElkOiBzdHJpbmcpOiBNb25lcm9UeENvbmZpZyB7XG4gICAgdGhpcy5wYXltZW50SWQgPSBwYXltZW50SWQ7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIGdldFByaW9yaXR5KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMucHJpb3JpdHk7XG4gIH1cbiAgXG4gIHNldFByaW9yaXR5KHByaW9yaXR5OiBudW1iZXIpOiBNb25lcm9UeENvbmZpZyB7XG4gICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICBnZXRGZWUoKTogYmlnaW50IHtcbiAgICByZXR1cm4gdGhpcy5mZWU7XG4gIH1cbiAgXG4gIHNldEZlZShmZWU6IGJpZ2ludCk6IE1vbmVyb1R4Q29uZmlnIHtcbiAgICB0aGlzLmZlZSA9IGZlZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBcbiAgZ2V0QWNjb3VudEluZGV4KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuYWNjb3VudEluZGV4O1xuICB9XG4gIFxuICBzZXRBY2NvdW50SW5kZXgoYWNjb3VudEluZGV4OiBudW1iZXIpOiBNb25lcm9UeENvbmZpZyB7XG4gICAgdGhpcy5hY2NvdW50SW5kZXggPSBhY2NvdW50SW5kZXg7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIHNldFN1YmFkZHJlc3NJbmRleChzdWJhZGRyZXNzSW5kZXg6IG51bWJlcik6IE1vbmVyb1R4Q29uZmlnIHtcbiAgICB0aGlzLnNldFN1YmFkZHJlc3NJbmRpY2VzKFtzdWJhZGRyZXNzSW5kZXhdKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBcbiAgZ2V0U3ViYWRkcmVzc0luZGljZXMoKTogbnVtYmVyW10ge1xuICAgIHJldHVybiB0aGlzLnN1YmFkZHJlc3NJbmRpY2VzO1xuICB9XG4gIFxuICBzZXRTdWJhZGRyZXNzSW5kaWNlcyhzdWJhZGRyZXNzSW5kaWNlczogbnVtYmVyW10pOiBNb25lcm9UeENvbmZpZyB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSBzdWJhZGRyZXNzSW5kaWNlcyA9IEFycmF5LmZyb20oYXJndW1lbnRzKTtcbiAgICB0aGlzLnN1YmFkZHJlc3NJbmRpY2VzID0gc3ViYWRkcmVzc0luZGljZXM7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIGdldFVubG9ja1RpbWUoKTogYmlnaW50IHtcbiAgICByZXR1cm4gdGhpcy51bmxvY2tUaW1lO1xuICB9XG4gIFxuICBzZXRVbmxvY2tUaW1lKHVubG9ja1RpbWU6IGJpZ2ludCk6IE1vbmVyb1R4Q29uZmlnIHtcbiAgICB0aGlzLnVubG9ja1RpbWUgPSB1bmxvY2tUaW1lO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICBnZXRSZWxheSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5yZWxheTtcbiAgfVxuICBcbiAgc2V0UmVsYXkocmVsYXk6IGJvb2xlYW4pOiBNb25lcm9UeENvbmZpZyB7XG4gICAgdGhpcy5yZWxheSA9IHJlbGF5O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICBnZXRDYW5TcGxpdCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5jYW5TcGxpdDtcbiAgfVxuICBcbiAgc2V0Q2FuU3BsaXQoY2FuU3BsaXQ6IGJvb2xlYW4pOiBNb25lcm9UeENvbmZpZyB7XG4gICAgdGhpcy5jYW5TcGxpdCA9IGNhblNwbGl0O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICBnZXROb3RlKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMubm90ZTtcbiAgfVxuICBcbiAgc2V0Tm90ZShub3RlOiBzdHJpbmcpOiBNb25lcm9UeENvbmZpZyB7XG4gICAgdGhpcy5ub3RlID0gbm90ZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBcbiAgZ2V0UmVjaXBpZW50TmFtZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLnJlY2lwaWVudE5hbWU7XG4gIH1cbiAgXG4gIHNldFJlY2lwaWVudE5hbWUocmVjaXBpZW50TmFtZTogc3RyaW5nKTogTW9uZXJvVHhDb25maWcge1xuICAgIHRoaXMucmVjaXBpZW50TmFtZSA9IHJlY2lwaWVudE5hbWU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBTUEVDSUZJQyBUTyBTV0VFUCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIFxuICBnZXRCZWxvd0Ftb3VudCgpIHtcbiAgICByZXR1cm4gdGhpcy5iZWxvd0Ftb3VudDtcbiAgfVxuICBcbiAgc2V0QmVsb3dBbW91bnQoYmVsb3dBbW91bnQpIHtcbiAgICB0aGlzLmJlbG93QW1vdW50ID0gYmVsb3dBbW91bnQ7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIGdldFN3ZWVwRWFjaFN1YmFkZHJlc3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3dlZXBFYWNoU3ViYWRkcmVzcztcbiAgfVxuICBcbiAgc2V0U3dlZXBFYWNoU3ViYWRkcmVzcyhzd2VlcEVhY2hTdWJhZGRyZXNzKSB7XG4gICAgdGhpcy5zd2VlcEVhY2hTdWJhZGRyZXNzID0gc3dlZXBFYWNoU3ViYWRkcmVzcztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBcbiAgLyoqXG4gICAqIEdldCB0aGUga2V5IGltYWdlIGhleCBvZiB0aGUgb3V0cHV0IHRvIHN3ZWVwLlxuICAgKiBcbiAgICogcmV0dXJuIHtzdHJpbmd9IGlzIHRoZSBrZXkgaW1hZ2UgaGV4IG9mIHRoZSBvdXRwdXQgdG8gc3dlZXBcbiAgICovXG4gIGdldEtleUltYWdlKCkge1xuICAgIHJldHVybiB0aGlzLmtleUltYWdlO1xuICB9XG4gIFxuICAvKipcbiAgICogU2V0IHRoZSBrZXkgaW1hZ2UgaGV4IG9mIHRoZSBvdXRwdXQgdG8gc3dlZXAuXG4gICAqIFxuICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5SW1hZ2UgaXMgdGhlIGtleSBpbWFnZSBoZXggb2YgdGhlIG91dHB1dCB0byBzd2VlcFxuICAgKi9cbiAgc2V0S2V5SW1hZ2Uoa2V5SW1hZ2UpIHtcbiAgICB0aGlzLmtleUltYWdlID0ga2V5SW1hZ2U7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6InlMQUFBLElBQUFBLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLGtCQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxZQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNlLE1BQU1HLGNBQWMsQ0FBQzs7RUFFbEM7OztFQUdBOzs7RUFHQTs7O0VBR0E7OztFQUdBOzs7RUFHQTs7O0VBR0E7OztFQUdBOzs7RUFHQTs7O0VBR0E7OztFQUdBOzs7RUFHQTs7O0VBR0E7OztFQUdBOzs7RUFHQTs7O0VBR0E7OztFQUdBOzs7RUFHQTs7O0VBR0E7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDRUMsV0FBV0EsQ0FBQ0MsTUFBZ0MsRUFBRTtJQUM1Q0MsTUFBTSxDQUFDQyxNQUFNLENBQUMsSUFBSSxFQUFFRixNQUFNLENBQUM7O0lBRTNCO0lBQ0EsSUFBSSxJQUFJLENBQUNHLE1BQU0sS0FBS0MsU0FBUyxJQUFJLE9BQU8sSUFBSSxDQUFDRCxNQUFNLEtBQUssUUFBUSxFQUFFLElBQUksQ0FBQ0EsTUFBTSxHQUFHRSxNQUFNLENBQUMsSUFBSSxDQUFDRixNQUFNLENBQUM7SUFDbkcsSUFBSSxJQUFJLENBQUNHLEdBQUcsS0FBS0YsU0FBUyxJQUFJLE9BQU8sSUFBSSxDQUFDRSxHQUFHLEtBQUssUUFBUSxFQUFFLElBQUksQ0FBQ0EsR0FBRyxHQUFHRCxNQUFNLENBQUMsSUFBSSxDQUFDQyxHQUFH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