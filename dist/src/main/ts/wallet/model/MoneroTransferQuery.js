"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;

var _MoneroIncomingTransfer = _interopRequireDefault(require("./MoneroIncomingTransfer"));
var _MoneroOutgoingTransfer = _interopRequireDefault(require("./MoneroOutgoingTransfer"));
var _MoneroTransfer = _interopRequireDefault(require("./MoneroTransfer"));

var _MoneroTxQuery = _interopRequireDefault(require("./MoneroTxQuery"));
var _MoneroError = _interopRequireDefault(require("../../common/MoneroError"));

/**
 * Configuration to query wallet transfers.
 */
class MoneroTransferQuery extends _MoneroTransfer.default {










  /**
   * <p>Construct the transfer query.</p>
   * 
   * <p>Example:</p>
   * 
   * <code>
   * &sol;&sol; get incoming transfers to account 0, subaddress 1<br>
   * let transfers = await wallet.getTransfers({<br>
   * &nbsp;&nbsp; accountIndex: 0,<br>
   * &nbsp;&nbsp; subaddressIndex: 0<br>
   * });
   * </code>
   * 
   * <p>All configuration is optional.  All transfers are returned except those that don't meet criteria defined in this query.</p>
   * 
   * @param {Partial<MoneroTransferQuery>} [query] - transfer query configuration (optional)
   * @param {bigint} query.amount - get transfers with this amount
   * @param {number} query.accountIndex - get transfers to/from this account index
   * @param {number} query.subaddressIndex - get transfers to/from this subaddress index
   * @param {number[]} query.subaddressIndices - get transfers to/from these subaddress indices
   * @param {string} query.address - get transfers to/from this wallet address
   * @param {string[]} query.addresses - get transfers to/from these wallet addresses
   * @param {boolean} query.isIncoming - get transfers which are incoming if true
   * @param {boolean} query.isOutgoing - get transfers which are outgoing if true
   * @param {boolean} query.hasDestinations - get transfers with known destinations if true (destinations are only stored locally with the wallet)
   * @param {MoneroTxQuery} query.txQuery - get transfers whose tx match this tx query
   */
  constructor(query) {
    super(query);
    if (this.txQuery && !(this.txQuery instanceof _MoneroTxQuery.default)) this.txQuery = new _MoneroTxQuery.default(this.txQuery);
    if (this.txQuery) this.txQuery.setTransferQuery(this);

    // alias isOutgoing to isIncoming
    if (this.isOutgoing !== undefined) this.isIncoming = !this.isOutgoing;
    this.validate();
  }

  copy() {
    return new MoneroTransferQuery(this);
  }

  toJson() {
    let json = Object.assign({}, this, super.toJson());
    delete json.txQuery;
    return json;
  }

  getTxQuery() {
    return this.txQuery;
  }

  setTxQuery(txQuery) {
    this.txQuery = txQuery;
    if (txQuery) txQuery.setTransferQuery(this);
    return this;
  }

  getIsIncoming() {
    return this.isIncoming;
  }

  setIsIncoming(isIncoming) {
    this.isIncoming = isIncoming;
    return this;
  }

  getIsOutgoing() {
    return this.isIncoming === undefined ? undefined : !this.isIncoming;
  }

  setIsOutgoing(isOutgoing) {
    this.isIncoming = isOutgoing === undefined ? undefined : !isOutgoing;
    return this;
  }

  getAddress() {
    return this.address;
  }

  setAddress(address) {
    this.address = address;
    return this;
  }

  getAddresses() {
    return this.addresses;
  }

  setAddresses(addresses) {
    this.addresses = addresses;
    return this;
  }

  getSubaddressIndex() {
    return this.subaddressIndex;
  }

  setSubaddressIndex(subaddressIndex) {
    this.subaddressIndex = subaddressIndex;
    this.validate();
    return this;
  }

  getSubaddressIndices() {
    return this.subaddressIndices;
  }

  setSubaddressIndices(subaddressIndices) {
    this.subaddressIndices = subaddressIndices;
    this.validate();
    return this;
  }

  getDestinations() {
    return this.destinations;
  }

  setDestinations(destinations) {
    this.destinations = destinations;
    return this;
  }

  getHasDestinations() {
    return this.hasDestinations;
  }

  setHasDestinations(hasDestinations) {
    this.hasDestinations = hasDestinations;
    return this;
  }

  /**
   * Convenience method to query outputs by the locked state of their tx.
   * 
   * @param isLocked specifies if the output's tx must be locked or unlocked (optional)
   * @return {MoneroOutputQuery} this query for chaining
   */
  setIsLocked(isLocked) {
    if (this.txQuery === undefined) this.txQuery = new _MoneroTxQuery.default();
    this.getTxQuery().setIsLocked(isLocked);
    return this;
  }

  meetsCriteria(transfer, queryParent = true) {
    if (!(transfer instanceof _MoneroTransfer.default)) throw new Error("Transfer not given to MoneroTransferQuery.meetsCriteria(transfer)");

    // filter on common fields
    if (this.getIsIncoming() !== undefined && this.getIsIncoming() !== transfer.getIsIncoming()) return false;
    if (this.getIsOutgoing() !== undefined && this.getIsOutgoing() !== transfer.getIsOutgoing()) return false;
    if (this.getAmount() !== undefined && this.getAmount() !== transfer.getAmount()) return false;
    if (this.getAccountIndex() !== undefined && this.getAccountIndex() !== transfer.getAccountIndex()) return false;

    // filter on incoming fields
    if (transfer instanceof _MoneroIncomingTransfer.default) {
      if (this.getHasDestinations() !== undefined) return false;
      if (this.getAddress() !== undefined && this.getAddress() !== transfer.getAddress()) return false;
      if (this.getAddresses() !== undefined && !this.getAddresses().includes(transfer.getAddress())) return false;
      if (this.getSubaddressIndex() !== undefined && this.getSubaddressIndex() !== transfer.getSubaddressIndex()) return false;
      if (this.getSubaddressIndices() !== undefined && !this.getSubaddressIndices().includes(transfer.getSubaddressIndex())) return false;
    }

    // filter on outgoing fields
    else if (transfer instanceof _MoneroOutgoingTransfer.default) {

      // filter on addresses which must have overlap
      if (this.getAddress() !== undefined && (transfer.getAddresses() === undefined || !transfer.getAddresses().includes(this.getAddress()))) return false; // TODO: will filter all transfers that don't contain addresses (outgoing txs might not have this field initialized)
      if (this.getAddresses() !== undefined) {
        if (!transfer.getAddresses()) return false;
        if (!this.getAddresses().some((address) => transfer.getAddresses().includes(address))) return false;
      }

      // filter on subaddress indices
      if (this.getSubaddressIndex() !== undefined && (transfer.getSubaddressIndices() === undefined || !transfer.getSubaddressIndices().includes(this.getSubaddressIndex()))) return false;
      if (this.getSubaddressIndices() !== undefined) {
        if (!transfer.getSubaddressIndices()) return false;
        if (!this.getSubaddressIndices().some((subaddressIdx) => transfer.getSubaddressIndices().includes(subaddressIdx))) return false;
      }

      // filter on having destinations
      if (this.getHasDestinations() !== undefined) {
        if (this.getHasDestinations() && transfer.getDestinations() === undefined) return false;
        if (!this.getHasDestinations() && transfer.getDestinations() !== undefined) return false;
      }

      // filter on destinations TODO: start with test for this
      //    if (this.getDestionations() !== undefined && this.getDestionations() !== transfer.getDestionations()) return false;
    }

    // otherwise invalid type
    else throw new Error("Transfer must be MoneroIncomingTransfer or MoneroOutgoingTransfer");

    // filter with tx filter
    if (queryParent && this.getTxQuery() !== undefined && !this.getTxQuery().meetsCriteria(transfer.getTx())) return false;
    return true;
  }

  validate() {
    if (this.getSubaddressIndex() !== undefined && this.getSubaddressIndex() < 0) throw new _MoneroError.default("Subaddress index must be >= 0");
    if (this.getSubaddressIndices() !== undefined) for (let subaddressIdx of this.getSubaddressIndices()) if (subaddressIdx < 0) throw new _MoneroError.default("Subaddress indices must be >= 0");
  }

  // -------------------- OVERRIDE COVARIANT RETURN TYPES ---------------------

  setTx(tx) {
    super.setTx(tx);
    return this;
  }

  setAmount(amount) {
    super.setAmount(amount);
    return this;
  }

  setAccountIndex(accountIndex) {
    super.setAccountIndex(accountIndex);
    return this;
  }
}exports.default = MoneroTransferQuery;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfTW9uZXJvSW5jb21pbmdUcmFuc2ZlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX01vbmVyb091dGdvaW5nVHJhbnNmZXIiLCJfTW9uZXJvVHJhbnNmZXIiLCJfTW9uZXJvVHhRdWVyeSIsIl9Nb25lcm9FcnJvciIsIk1vbmVyb1RyYW5zZmVyUXVlcnkiLCJNb25lcm9UcmFuc2ZlciIsImNvbnN0cnVjdG9yIiwicXVlcnkiLCJ0eFF1ZXJ5IiwiTW9uZXJvVHhRdWVyeSIsInNldFRyYW5zZmVyUXVlcnkiLCJpc091dGdvaW5nIiwidW5kZWZpbmVkIiwiaXNJbmNvbWluZyIsInZhbGlkYXRlIiwiY29weSIsInRvSnNvbiIsImpzb24iLCJPYmplY3QiLCJhc3NpZ24iLCJnZXRUeFF1ZXJ5Iiwic2V0VHhRdWVyeSIsImdldElzSW5jb21pbmciLCJzZXRJc0luY29taW5nIiwiZ2V0SXNPdXRnb2luZyIsInNldElzT3V0Z29pbmciLCJnZXRBZGRyZXNzIiwiYWRkcmVzcyIsInNldEFkZHJlc3MiLCJnZXRBZGRyZXNzZXMiLCJhZGRyZXNzZXMiLCJzZXRBZGRyZXNzZXMiLCJnZXRTdWJhZGRyZXNzSW5kZXgiLCJzdWJhZGRyZXNzSW5kZXgiLCJzZXRTdWJhZGRyZXNzSW5kZXgiLCJnZXRTdWJhZGRyZXNzSW5kaWNlcyIsInN1YmFkZHJlc3NJbmRpY2VzIiwic2V0U3ViYWRkcmVzc0luZGljZXMiLCJnZXREZXN0aW5hdGlvbnMiLCJkZXN0aW5hdGlvbnMiLCJzZXREZXN0aW5hdGlvbnMiLCJnZXRIYXNEZXN0aW5hdGlvbnMiLCJoYXNEZXN0aW5hdGlvbnMiLCJzZXRIYXNEZXN0aW5hdGlvbnMiLCJzZXRJc0xvY2tlZCIsImlzTG9ja2VkIiwibWVldHNDcml0ZXJpYSIsInRyYW5zZmVyIiwicXVlcnlQYXJlbnQiLCJFcnJvciIsImdldEFtb3VudCIsImdldEFjY291bnRJbmRleCIsIk1vbmVyb0luY29taW5nVHJhbnNmZXIiLCJpbmNsdWRlcyIsIk1vbmVyb091dGdvaW5nVHJhbnNmZXIiLCJzb21lIiwic3ViYWRkcmVzc0lkeCIsImdldFR4IiwiTW9uZXJvRXJyb3IiLCJzZXRUeCIsInR4Iiwic2V0QW1vdW50IiwiYW1vdW50Iiwic2V0QWNjb3VudEluZGV4IiwiYWNjb3VudEluZGV4IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvbWFpbi90cy93YWxsZXQvbW9kZWwvTW9uZXJvVHJhbnNmZXJRdWVyeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgR2VuVXRpbHMgZnJvbSBcIi4uLy4uL2NvbW1vbi9HZW5VdGlsc1wiO1xuaW1wb3J0IE1vbmVyb0Rlc3RpbmF0aW9uIGZyb20gXCIuL01vbmVyb0Rlc3RpbmF0aW9uXCI7XG5pbXBvcnQgTW9uZXJvSW5jb21pbmdUcmFuc2ZlciBmcm9tIFwiLi9Nb25lcm9JbmNvbWluZ1RyYW5zZmVyXCI7XG5pbXBvcnQgTW9uZXJvT3V0Z29pbmdUcmFuc2ZlciBmcm9tIFwiLi9Nb25lcm9PdXRnb2luZ1RyYW5zZmVyXCI7XG5pbXBvcnQgTW9uZXJvVHJhbnNmZXIgZnJvbSBcIi4vTW9uZXJvVHJhbnNmZXJcIjtcbmltcG9ydCBNb25lcm9UeFdhbGxldCBmcm9tIFwiLi9Nb25lcm9UeFdhbGxldFwiO1xuaW1wb3J0IE1vbmVyb1R4UXVlcnkgZnJvbSBcIi4vTW9uZXJvVHhRdWVyeVwiO1xuaW1wb3J0IE1vbmVyb0Vycm9yIGZyb20gXCIuLi8uLi9jb21tb24vTW9uZXJvRXJyb3JcIjtcblxuLyoqXG4gKiBDb25maWd1cmF0aW9uIHRvIHF1ZXJ5IHdhbGxldCB0cmFuc2ZlcnMuXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vbmVyb1RyYW5zZmVyUXVlcnkgZXh0ZW5kcyBNb25lcm9UcmFuc2ZlciB7XG5cbiAgdHhRdWVyeTogUGFydGlhbDxNb25lcm9UeFF1ZXJ5PjtcbiAgaXNJbmNvbWluZzogYm9vbGVhbjtcbiAgYWRkcmVzczogc3RyaW5nO1xuICBhZGRyZXNzZXM6IHN0cmluZ1tdO1xuICBzdWJhZGRyZXNzSW5kZXg6IG51bWJlcjtcbiAgc3ViYWRkcmVzc0luZGljZXM6IG51bWJlcltdO1xuICBkZXN0aW5hdGlvbnM6IE1vbmVyb0Rlc3RpbmF0aW9uW107XG4gIGhhc0Rlc3RpbmF0aW9uczogYm9vbGVhbjtcbiAgXG4gIC8qKlxuICAgKiA8cD5Db25zdHJ1Y3QgdGhlIHRyYW5zZmVyIHF1ZXJ5LjwvcD5cbiAgICogXG4gICAqIDxwPkV4YW1wbGU6PC9wPlxuICAgKiBcbiAgICogPGNvZGU+XG4gICAqICZzb2w7JnNvbDsgZ2V0IGluY29taW5nIHRyYW5zZmVycyB0byBhY2NvdW50IDAsIHN1YmFkZHJlc3MgMTxicj5cbiAgICogbGV0IHRyYW5zZmVycyA9IGF3YWl0IHdhbGxldC5nZXRUcmFuc2ZlcnMoezxicj5cbiAgICogJm5ic3A7Jm5ic3A7IGFjY291bnRJbmRleDogMCw8YnI+XG4gICAqICZuYnNwOyZuYnNwOyBzdWJhZGRyZXNzSW5kZXg6IDA8YnI+XG4gICAqIH0pO1xuICAgKiA8L2NvZGU+XG4gICAqIFxuICAgKiA8cD5BbGwgY29uZmlndXJhdGlvbiBpcyBvcHRpb25hbC4gIEFsbCB0cmFuc2ZlcnMgYXJlIHJldHVybmVkIGV4Y2VwdCB0aG9zZSB0aGF0IGRvbid0IG1lZXQgY3JpdGVyaWEgZGVmaW5lZCBpbiB0aGlzIHF1ZXJ5LjwvcD5cbiAgICogXG4gICAqIEBwYXJhbSB7UGFydGlhbDxNb25lcm9UcmFuc2ZlclF1ZXJ5Pn0gW3F1ZXJ5XSAtIHRyYW5zZmVyIHF1ZXJ5IGNvbmZpZ3VyYXRpb24gKG9wdGlvbmFsKVxuICAgKiBAcGFyYW0ge2JpZ2ludH0gcXVlcnkuYW1vdW50IC0gZ2V0IHRyYW5zZmVycyB3aXRoIHRoaXMgYW1vdW50XG4gICAqIEBwYXJhbSB7bnVtYmVyfSBxdWVyeS5hY2NvdW50SW5kZXggLSBnZXQgdHJhbnNmZXJzIHRvL2Zyb20gdGhpcyBhY2NvdW50IGluZGV4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSBxdWVyeS5zdWJhZGRyZXNzSW5kZXggLSBnZXQgdHJhbnNmZXJzIHRvL2Zyb20gdGhpcyBzdWJhZGRyZXNzIGluZGV4XG4gICAqIEBwYXJhbSB7bnVtYmVyW119IHF1ZXJ5LnN1YmFkZHJlc3NJbmRpY2VzIC0gZ2V0IHRyYW5zZmVycyB0by9mcm9tIHRoZXNlIHN1YmFkZHJlc3MgaW5kaWNlc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gcXVlcnkuYWRkcmVzcyAtIGdldCB0cmFuc2ZlcnMgdG8vZnJvbSB0aGlzIHdhbGxldCBhZGRyZXNzXG4gICAqIEBwYXJhbSB7c3RyaW5nW119IHF1ZXJ5LmFkZHJlc3NlcyAtIGdldCB0cmFuc2ZlcnMgdG8vZnJvbSB0aGVzZSB3YWxsZXQgYWRkcmVzc2VzXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gcXVlcnkuaXNJbmNvbWluZyAtIGdldCB0cmFuc2ZlcnMgd2hpY2ggYXJlIGluY29taW5nIGlmIHRydWVcbiAgICogQHBhcmFtIHtib29sZWFufSBxdWVyeS5pc091dGdvaW5nIC0gZ2V0IHRyYW5zZmVycyB3aGljaCBhcmUgb3V0Z29pbmcgaWYgdHJ1ZVxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHF1ZXJ5Lmhhc0Rlc3RpbmF0aW9ucyAtIGdldCB0cmFuc2ZlcnMgd2l0aCBrbm93biBkZXN0aW5hdGlvbnMgaWYgdHJ1ZSAoZGVzdGluYXRpb25zIGFyZSBvbmx5IHN0b3JlZCBsb2NhbGx5IHdpdGggdGhlIHdhbGxldClcbiAgICogQHBhcmFtIHtNb25lcm9UeFF1ZXJ5fSBxdWVyeS50eFF1ZXJ5IC0gZ2V0IHRyYW5zZmVycyB3aG9zZSB0eCBtYXRjaCB0aGlzIHR4IHF1ZXJ5XG4gICAqL1xuICBjb25zdHJ1Y3RvcihxdWVyeT86IFBhcnRpYWw8TW9uZXJvVHJhbnNmZXJRdWVyeT4pIHtcbiAgICBzdXBlcihxdWVyeSk7XG4gICAgaWYgKHRoaXMudHhRdWVyeSAmJiAhKHRoaXMudHhRdWVyeSBpbnN0YW5jZW9mIE1vbmVyb1R4UXVlcnkpKSB0aGlzLnR4UXVlcnkgPSBuZXcgTW9uZXJvVHhRdWVyeSh0aGlzLnR4UXVlcnkpO1xuICAgIGlmICh0aGlzLnR4UXVlcnkpIHRoaXMudHhRdWVyeS5zZXRUcmFuc2ZlclF1ZXJ5KHRoaXMpO1xuXG4gICAgLy8gYWxpYXMgaXNPdXRnb2luZyB0byBpc0luY29taW5nXG4gICAgaWYgKCh0aGlzIGFzIGFueSkuaXNPdXRnb2luZyAhPT0gdW5kZWZpbmVkKSB0aGlzLmlzSW5jb21pbmcgPSAhKHRoaXMgYXMgYW55KS5pc091dGdvaW5nO1xuICAgIHRoaXMudmFsaWRhdGUoKTtcbiAgfVxuICBcbiAgY29weSgpOiBNb25lcm9UcmFuc2ZlclF1ZXJ5IHtcbiAgICByZXR1cm4gbmV3IE1vbmVyb1RyYW5zZmVyUXVlcnkodGhpcyk7XG4gIH1cbiAgXG4gIHRvSnNvbigpOiBhbnkge1xuICAgIGxldCBqc29uID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcywgc3VwZXIudG9Kc29uKCkpO1xuICAgIGRlbGV0ZSBqc29uLnR4UXVlcnk7XG4gICAgcmV0dXJuIGpzb247XG4gIH1cbiAgXG4gIGdldFR4UXVlcnkoKTogTW9uZXJvVHhRdWVyeSB7XG4gICAgcmV0dXJuIHRoaXMudHhRdWVyeSBhcyBNb25lcm9UeFF1ZXJ5O1xuICB9XG4gIFxuICBzZXRUeFF1ZXJ5KHR4UXVlcnk6IE1vbmVyb1R4UXVlcnkpOiBNb25lcm9UcmFuc2ZlclF1ZXJ5IHtcbiAgICB0aGlzLnR4UXVlcnkgPSB0eFF1ZXJ5O1xuICAgIGlmICh0eFF1ZXJ5KSB0eFF1ZXJ5LnNldFRyYW5zZmVyUXVlcnkodGhpcyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIGdldElzSW5jb21pbmcoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaXNJbmNvbWluZztcbiAgfVxuXG4gIHNldElzSW5jb21pbmcoaXNJbmNvbWluZzogYm9vbGVhbik6IE1vbmVyb1RyYW5zZmVyUXVlcnkge1xuICAgIHRoaXMuaXNJbmNvbWluZyA9IGlzSW5jb21pbmc7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIGdldElzT3V0Z29pbmcoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaXNJbmNvbWluZyA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogIXRoaXMuaXNJbmNvbWluZztcbiAgfVxuICBcbiAgc2V0SXNPdXRnb2luZyhpc091dGdvaW5nOiBib29sZWFuKTogTW9uZXJvVHJhbnNmZXJRdWVyeSB7XG4gICAgdGhpcy5pc0luY29taW5nID0gaXNPdXRnb2luZyA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogIWlzT3V0Z29pbmc7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIGdldEFkZHJlc3MoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5hZGRyZXNzO1xuICB9XG5cbiAgc2V0QWRkcmVzcyhhZGRyZXNzOiBzdHJpbmcpOiBNb25lcm9UcmFuc2ZlclF1ZXJ5IHtcbiAgICB0aGlzLmFkZHJlc3MgPSBhZGRyZXNzO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICBnZXRBZGRyZXNzZXMoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiB0aGlzLmFkZHJlc3NlcztcbiAgfVxuXG4gIHNldEFkZHJlc3NlcyhhZGRyZXNzZXM6IHN0cmluZ1tdKTogTW9uZXJvVHJhbnNmZXJRdWVyeSB7XG4gICAgdGhpcy5hZGRyZXNzZXMgPSBhZGRyZXNzZXM7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIGdldFN1YmFkZHJlc3NJbmRleCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnN1YmFkZHJlc3NJbmRleDtcbiAgfVxuICBcbiAgc2V0U3ViYWRkcmVzc0luZGV4KHN1YmFkZHJlc3NJbmRleDogbnVtYmVyKTogTW9uZXJvVHJhbnNmZXJRdWVyeSB7XG4gICAgdGhpcy5zdWJhZGRyZXNzSW5kZXggPSBzdWJhZGRyZXNzSW5kZXg7XG4gICAgdGhpcy52YWxpZGF0ZSgpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICBnZXRTdWJhZGRyZXNzSW5kaWNlcygpOiBudW1iZXJbXSB7XG4gICAgcmV0dXJuIHRoaXMuc3ViYWRkcmVzc0luZGljZXM7XG4gIH1cbiAgXG4gIHNldFN1YmFkZHJlc3NJbmRpY2VzKHN1YmFkZHJlc3NJbmRpY2VzOiBudW1iZXJbXSk6IE1vbmVyb1RyYW5zZmVyUXVlcnkge1xuICAgIHRoaXMuc3ViYWRkcmVzc0luZGljZXMgPSBzdWJhZGRyZXNzSW5kaWNlcztcbiAgICB0aGlzLnZhbGlkYXRlKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIGdldERlc3RpbmF0aW9ucygpOiBNb25lcm9EZXN0aW5hdGlvbltdIHtcbiAgICByZXR1cm4gdGhpcy5kZXN0aW5hdGlvbnM7XG4gIH1cbiAgXG4gIHNldERlc3RpbmF0aW9ucyhkZXN0aW5hdGlvbnM6IE1vbmVyb0Rlc3RpbmF0aW9uW10pIHtcbiAgICB0aGlzLmRlc3RpbmF0aW9ucyA9IGRlc3RpbmF0aW9ucztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBcbiAgZ2V0SGFzRGVzdGluYXRpb25zKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmhhc0Rlc3RpbmF0aW9ucztcbiAgfVxuICBcbiAgc2V0SGFzRGVzdGluYXRpb25zKGhhc0Rlc3RpbmF0aW9uczogYm9vbGVhbik6IE1vbmVyb1RyYW5zZmVyUXVlcnkge1xuICAgIHRoaXMuaGFzRGVzdGluYXRpb25zID0gaGFzRGVzdGluYXRpb25zO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIFxuICAvKipcbiAgICogQ29udmVuaWVuY2UgbWV0aG9kIHRvIHF1ZXJ5IG91dHB1dHMgYnkgdGhlIGxvY2tlZCBzdGF0ZSBvZiB0aGVpciB0eC5cbiAgICogXG4gICAqIEBwYXJhbSBpc0xvY2tlZCBzcGVjaWZpZXMgaWYgdGhlIG91dHB1dCdzIHR4IG11c3QgYmUgbG9ja2VkIG9yIHVubG9ja2VkIChvcHRpb25hbClcbiAgICogQHJldHVybiB7TW9uZXJvT3V0cHV0UXVlcnl9IHRoaXMgcXVlcnkgZm9yIGNoYWluaW5nXG4gICAqL1xuICBzZXRJc0xvY2tlZChpc0xvY2tlZDogYm9vbGVhbik6IE1vbmVyb1RyYW5zZmVyUXVlcnkge1xuICAgIGlmICh0aGlzLnR4UXVlcnkgPT09IHVuZGVmaW5lZCkgdGhpcy50eFF1ZXJ5ID0gbmV3IE1vbmVyb1R4UXVlcnkoKTtcbiAgICB0aGlzLmdldFR4UXVlcnkoKS5zZXRJc0xvY2tlZChpc0xvY2tlZCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgXG4gIG1lZXRzQ3JpdGVyaWEodHJhbnNmZXI6IE1vbmVyb1RyYW5zZmVyLCBxdWVyeVBhcmVudCA9IHRydWUpOiBib29sZWFuIHtcbiAgICBpZiAoISh0cmFuc2ZlciBpbnN0YW5jZW9mIE1vbmVyb1RyYW5zZmVyKSkgdGhyb3cgbmV3IEVycm9yKFwiVHJhbnNmZXIgbm90IGdpdmVuIHRvIE1vbmVyb1RyYW5zZmVyUXVlcnkubWVldHNDcml0ZXJpYSh0cmFuc2ZlcilcIik7XG4gICAgXG4gICAgLy8gZmlsdGVyIG9uIGNvbW1vbiBmaWVsZHNcbiAgICBpZiAodGhpcy5nZXRJc0luY29taW5nKCkgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmdldElzSW5jb21pbmcoKSAhPT0gdHJhbnNmZXIuZ2V0SXNJbmNvbWluZygpKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKHRoaXMuZ2V0SXNPdXRnb2luZygpICE9PSB1bmRlZmluZWQgJiYgdGhpcy5nZXRJc091dGdvaW5nKCkgIT09IHRyYW5zZmVyLmdldElzT3V0Z29pbmcoKSkgcmV0dXJuIGZhbHNlO1xuICAgIGlmICh0aGlzLmdldEFtb3VudCgpICE9PSB1bmRlZmluZWQgJiYgdGhpcy5nZXRBbW91bnQoKSAhPT0gdHJhbnNmZXIuZ2V0QW1vdW50KCkpIHJldHVybiBmYWxzZTtcbiAgICBpZiAodGhpcy5nZXRBY2NvdW50SW5kZXgoKSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuZ2V0QWNjb3VudEluZGV4KCkgIT09IHRyYW5zZmVyLmdldEFjY291bnRJbmRleCgpKSByZXR1cm4gZmFsc2U7XG4gICAgXG4gICAgLy8gZmlsdGVyIG9uIGluY29taW5nIGZpZWxkc1xuICAgIGlmICh0cmFuc2ZlciBpbnN0YW5jZW9mIE1vbmVyb0luY29taW5nVHJhbnNmZXIpIHtcbiAgICAgIGlmICh0aGlzLmdldEhhc0Rlc3RpbmF0aW9ucygpICE9PSB1bmRlZmluZWQpIHJldHVybiBmYWxzZTtcbiAgICAgIGlmICh0aGlzLmdldEFkZHJlc3MoKSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuZ2V0QWRkcmVzcygpICE9PSB0cmFuc2Zlci5nZXRBZGRyZXNzKCkpIHJldHVybiBmYWxzZTtcbiAgICAgIGlmICh0aGlzLmdldEFkZHJlc3NlcygpICE9PSB1bmRlZmluZWQgJiYgIXRoaXMuZ2V0QWRkcmVzc2VzKCkuaW5jbHVkZXModHJhbnNmZXIuZ2V0QWRkcmVzcygpKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgaWYgKHRoaXMuZ2V0U3ViYWRkcmVzc0luZGV4KCkgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmdldFN1YmFkZHJlc3NJbmRleCgpICE9PSB0cmFuc2Zlci5nZXRTdWJhZGRyZXNzSW5kZXgoKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgaWYgKHRoaXMuZ2V0U3ViYWRkcmVzc0luZGljZXMoKSAhPT0gdW5kZWZpbmVkICYmICF0aGlzLmdldFN1YmFkZHJlc3NJbmRpY2VzKCkuaW5jbHVkZXModHJhbnNmZXIuZ2V0U3ViYWRkcmVzc0luZGV4KCkpKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gZmlsdGVyIG9uIG91dGdvaW5nIGZpZWxkc1xuICAgIGVsc2UgaWYgKHRyYW5zZmVyIGluc3RhbmNlb2YgTW9uZXJvT3V0Z29pbmdUcmFuc2Zlcikge1xuICAgICAgXG4gICAgICAvLyBmaWx0ZXIgb24gYWRkcmVzc2VzIHdoaWNoIG11c3QgaGF2ZSBvdmVybGFwXG4gICAgICBpZiAodGhpcy5nZXRBZGRyZXNzKCkgIT09IHVuZGVmaW5lZCAmJiAodHJhbnNmZXIuZ2V0QWRkcmVzc2VzKCkgPT09IHVuZGVmaW5lZCB8fCAhdHJhbnNmZXIuZ2V0QWRkcmVzc2VzKCkuaW5jbHVkZXModGhpcy5nZXRBZGRyZXNzKCkpKSkgcmV0dXJuIGZhbHNlOyAgIC8vIFRPRE86IHdpbGwgZmlsdGVyIGFsbCB0cmFuc2ZlcnMgdGhhdCBkb24ndCBjb250YWluIGFkZHJlc3NlcyAob3V0Z29pbmcgdHhzIG1pZ2h0IG5vdCBoYXZlIHRoaXMgZmllbGQgaW5pdGlhbGl6ZWQpXG4gICAgICBpZiAodGhpcy5nZXRBZGRyZXNzZXMoKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICghdHJhbnNmZXIuZ2V0QWRkcmVzc2VzKCkpIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKCF0aGlzLmdldEFkZHJlc3NlcygpLnNvbWUoYWRkcmVzcyA9PiB0cmFuc2Zlci5nZXRBZGRyZXNzZXMoKS5pbmNsdWRlcyhhZGRyZXNzKSkpIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gZmlsdGVyIG9uIHN1YmFkZHJlc3MgaW5kaWNlc1xuICAgICAgaWYgKHRoaXMuZ2V0U3ViYWRkcmVzc0luZGV4KCkgIT09IHVuZGVmaW5lZCAmJiAodHJhbnNmZXIuZ2V0U3ViYWRkcmVzc0luZGljZXMoKSA9PT0gdW5kZWZpbmVkIHx8ICF0cmFuc2Zlci5nZXRTdWJhZGRyZXNzSW5kaWNlcygpLmluY2x1ZGVzKHRoaXMuZ2V0U3ViYWRkcmVzc0luZGV4KCkpKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgaWYgKHRoaXMuZ2V0U3ViYWRkcmVzc0luZGljZXMoKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICghdHJhbnNmZXIuZ2V0U3ViYWRkcmVzc0luZGljZXMoKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAoIXRoaXMuZ2V0U3ViYWRkcmVzc0luZGljZXMoKS5zb21lKHN1YmFkZHJlc3NJZHggPT4gdHJhbnNmZXIuZ2V0U3ViYWRkcmVzc0luZGljZXMoKS5pbmNsdWRlcyhzdWJhZGRyZXNzSWR4KSkpIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gZmlsdGVyIG9uIGhhdmluZyBkZXN0aW5hdGlvbnNcbiAgICAgIGlmICh0aGlzLmdldEhhc0Rlc3RpbmF0aW9ucygpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKHRoaXMuZ2V0SGFzRGVzdGluYXRpb25zKCkgJiYgdHJhbnNmZXIuZ2V0RGVzdGluYXRpb25zKCkgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAoIXRoaXMuZ2V0SGFzRGVzdGluYXRpb25zKCkgJiYgdHJhbnNmZXIuZ2V0RGVzdGluYXRpb25zKCkgIT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBmaWx0ZXIgb24gZGVzdGluYXRpb25zIFRPRE86IHN0YXJ0IHdpdGggdGVzdCBmb3IgdGhpc1xuLy8gICAgaWYgKHRoaXMuZ2V0RGVzdGlvbmF0aW9ucygpICE9PSB1bmRlZmluZWQgJiYgdGhpcy5nZXREZXN0aW9uYXRpb25zKCkgIT09IHRyYW5zZmVyLmdldERlc3Rpb25hdGlvbnMoKSkgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICAvLyBvdGhlcndpc2UgaW52YWxpZCB0eXBlXG4gICAgZWxzZSB0aHJvdyBuZXcgRXJyb3IoXCJUcmFuc2ZlciBtdXN0IGJlIE1vbmVyb0luY29taW5nVHJhbnNmZXIgb3IgTW9uZXJvT3V0Z29pbmdUcmFuc2ZlclwiKTtcbiAgICBcbiAgICAvLyBmaWx0ZXIgd2l0aCB0eCBmaWx0ZXJcbiAgICBpZiAocXVlcnlQYXJlbnQgJiYgdGhpcy5nZXRUeFF1ZXJ5KCkgIT09IHVuZGVmaW5lZCAmJiAhdGhpcy5nZXRUeFF1ZXJ5KCkubWVldHNDcml0ZXJpYSh0cmFuc2Zlci5nZXRUeCgpKSkgcmV0dXJuIGZhbHNlOyAgICBcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBcbiAgdmFsaWRhdGUoKSB7XG4gICAgaWYgKHRoaXMuZ2V0U3ViYWRkcmVzc0luZGV4KCkgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmdldFN1YmFkZHJlc3NJbmRleCgpIDwgMCkgdGhyb3cgbmV3IE1vbmVyb0Vycm9yKFwiU3ViYWRkcmVzcyBpbmRleCBtdXN0IGJlID49IDBcIik7XG4gICAgaWYgKHRoaXMuZ2V0U3ViYWRkcmVzc0luZGljZXMoKSAhPT0gdW5kZWZpbmVkKSBmb3IgKGxldCBzdWJhZGRyZXNzSWR4IG9mIHRoaXMuZ2V0U3ViYWRkcmVzc0luZGljZXMoKSkgaWYgKHN1YmFkZHJlc3NJZHggPCAwKSB0aHJvdyBuZXcgTW9uZXJvRXJyb3IoXCJTdWJhZGRyZXNzIGluZGljZXMgbXVzdCBiZSA+PSAwXCIpO1xuICB9XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBPVkVSUklERSBDT1ZBUklBTlQgUkVUVVJOIFRZUEVTIC0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgc2V0VHgodHg6IE1vbmVyb1R4V2FsbGV0KTogTW9uZXJvVHJhbnNmZXJRdWVyeSB7XG4gICAgICBzdXBlci5zZXRUeCh0eCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIFxuICAgIHNldEFtb3VudChhbW91bnQ6IGJpZ2ludCk6IE1vbmVyb1RyYW5zZmVyUXVlcnkge1xuICAgICAgc3VwZXIuc2V0QW1vdW50KGFtb3VudCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIFxuICAgIHNldEFjY291bnRJbmRleChhY2NvdW50SW5kZXg6IG51bWJlcik6IE1vbmVyb1RyYW5zZmVyUXVlcnkge1xuICAgICAgc3VwZXIuc2V0QWNjb3VudEluZGV4KGFjY291bnRJbmRleCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG59XG4iXSwibWFwcGluZ3MiOiI7O0FBRUEsSUFBQUEsdUJBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLHVCQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxlQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7O0FBRUEsSUFB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